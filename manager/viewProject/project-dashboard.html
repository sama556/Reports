<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StratAnalytica | Project Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../../css/comman.css"/>
    <link rel="stylesheet" href="../../css/dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
  
</head>
<body>
    <header>
        <div class="container header-container">
            <a href="#" class="logo">
                <i class="fas fa-chart-network"></i>
                <span>StratAnalytica</span>
            </a>
            <nav>
                <ul>
                    <li><a href="../view-projects.html"><i class="fas fa-arrow-left"></i> Back</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="project-info">
                <h2 id="projectName">Digital Transformation Initiative</h2>
                <span class="project-status active" id="projectStatus">Active</span>
                
                <div class="project-meta">
                    <i class="fas fa-calendar-alt"></i>
                    <span id="projectDates">Mar 15, 2023 - Jun 30, 2023</span>
                </div>
                <div class="project-meta">
                    <i class="fas fa-user"></i>
                    <span id="projectCreator">Created by: Sarah Johnson</span>
                </div>
                <div class="project-meta">
                    <i class="fas fa-chart-pie"></i>
                    <span id="projectProgress">Progress: 65%</span>
                </div>
            </div>
            
            <ul class="sidebar-menu">
                <li><a href="../../manager/viewProject/project-dashboard.html" class="active" id="dashboardLink"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li><a href="../../manager/viewProject/risks.html"><i class="fas fa-exclamation-triangle"></i> Risks</a></li>
                <li><a href="../../manager/viewProject/kpis.html" id="kpisLink"><i class="fas fa-bullseye"></i> KPIs</a></li>
                <li><a href="../../manager/viewProject/Sales-Performance.html"><i class="fas fa-chart-line"></i> Sales Performance</a></li>
                <li><a href="../../manager/viewProject/feedback.html"><i class="fas fa-comment"></i> Feedback</a></li>
                <li><a href="../../manager/viewProject/todo.html"><i class="fas fa-tasks"></i> To-do List</a></li>
                <li><a href="../../manager/viewProject/budget.html"><i class="fas fa-wallet"></i> Budget</a></li>
                <li><a href="../../manager/viewProject/notifications.html"><i class="fas fa-bell"></i> Notifications</a></li>
                <li><a href="../../manager/viewProject/reports.html"><i class="fas fa-file-export"></i> Reports</a></li>
            </ul>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <div class="dashboard-header">
                <h1><i class="fas fa-tachometer-alt"></i> Project Dashboard</h1>
            </div>
            
            <!-- Key Metrics -->
            <div class="metric-grid">
                <div class="metric-card">
                    <h3>Days Remaining</h3>
                    <div class="metric-value" id="daysRemaining">45</div>
                    <div class="metric-description">Until project deadline</div>
                </div>
                <div class="metric-card">
                    <h3>Tasks Completed</h3>
                    <div class="metric-value" id="tasksCompleted">28/42</div>
                    <div class="metric-description">66.7% completed</div>
                </div>
                <div class="metric-card">
                    <h3>Budget Used</h3>
                    <div class="metric-value" id="budgetUsed">$42,500</div>
                    <div class="metric-description">70.8% of $60,000</div>
                </div>
                <div class="metric-card">
                    <h3>Team Members</h3>
                    <div class="metric-value" id="teamMembers">8</div>
                    <div class="metric-description">Active contributors</div>
                </div>
            </div>
            
            <!-- Chart Grid -->
            <div class="chart-grid">
                <!-- Chart 1: Project Budget vs Management -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-wallet"></i> Budget Allocation</h3>
                        <div class="chart-actions">
                            <button class="chart-btn" onclick="exportChart('budgetChart')"><i class="fas fa-download"></i></button>
                            <button class="chart-btn" onclick="toggleView('budgetChart')"><i class="fas fa-exchange-alt"></i></button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="budgetChart"></canvas>
                    </div>
                    <div class="chart-description">
                        Visualizes the budget allocation showing spent vs remaining amounts. Hover for exact values. Click 'Toggle' to switch between pie and bar views.
                    </div>
                </div>
                
                <!-- Chart 2: Risks vs Management -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-exclamation-triangle"></i> Risk Assessment</h3>
                        <div class="chart-actions">
                            <button class="chart-btn" onclick="exportChart('riskChart')"><i class="fas fa-download"></i></button>
                            <button class="chart-btn" onclick="toggleView('riskChart')"><i class="fas fa-exchange-alt"></i></button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="riskChart"></canvas>
                    </div>
                    <div class="chart-description">
                        Displays project risks by likelihood and impact. Zoom with mouse wheel. Click legend items to filter data.
                    </div>
                </div>
                
                <!-- Chart 3: To-do List vs Management -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-tasks"></i> Task Completion</h3>
                        <div class="chart-actions">
                            <button class="chart-btn" onclick="exportChart('taskChart')"><i class="fas fa-download"></i></button>
                            <button class="chart-btn" onclick="toggleView('taskChart')"><i class="fas fa-exchange-alt"></i></button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="taskChart"></canvas>
                    </div>
                    <div class="chart-description">
                        Shows task completion status by priority level. Hover for task counts. Drag to pan, scroll to zoom.
                    </div>
                </div>
                
                <!-- Chart 4: Timeline Gantt -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-calendar-alt"></i> Project Timeline</h3>
                        <div class="chart-actions">
                            <button class="chart-btn" onclick="exportChart('timelineChart')"><i class="fas fa-download"></i></button>
                            <button class="chart-btn" onclick="resetZoom('timelineChart')"><i class="fas fa-search-minus"></i></button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="timelineChart"></canvas>
                    </div>
                    <div class="chart-description">
                        Gantt chart showing project milestones and timeline. Click on bars for details. Use zoom/pan for navigation.
                    </div>
                </div>
                
                <!-- Chart 5: KPIs vs Management -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-tachometer-alt"></i> KPI Progress</h3>
                        <div class="chart-actions">
                            <button class="chart-btn" onclick="exportChart('kpiChart')"><i class="fas fa-download"></i></button>
                            <button class="chart-btn" onclick="toggleView('kpiChart')"><i class="fas fa-exchange-alt"></i></button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="kpiChart"></canvas>
                    </div>
                    <div class="chart-description">
                        Compares current KPI values against targets. Green indicates achieved, red indicates below target.
                    </div>
                </div>
                
                <!-- Chart 6: Audit Log -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-history"></i> Activity Timeline</h3>
                        <div class="chart-actions">
                            <button class="chart-btn" onclick="exportChart('auditChart')"><i class="fas fa-download"></i></button>
                            <button class="chart-btn" onclick="resetZoom('auditChart')"><i class="fas fa-search-minus"></i></button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="auditChart"></canvas>
                    </div>
                    <div class="chart-description">
                        Visualizes project activity over time from audit logs. Filter by action type using the legend.
                    </div>
                </div>
                
                <!-- Chart 7: Sales Performance -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-chart-line"></i> Sales Trends</h3>
                        <div class="chart-actions">
                            <button class="chart-btn" onclick="exportChart('salesChart')"><i class="fas fa-download"></i></button>
                            <button class="chart-btn" onclick="toggleView('salesChart')"><i class="fas fa-exchange-alt"></i></button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="salesChart"></canvas>
                    </div>
                    <div class="chart-description">
                        Shows sales performance metrics over time. Toggle between revenue and quantity views.
                    </div>
                </div>
                
                <!-- Chart 8: Project Progress -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-project-diagram"></i> Progress Tracking</h3>
                        <div class="chart-actions">
                            <button class="chart-btn" onclick="exportChart('progressChart')"><i class="fas fa-download"></i></button>
                            <button class="chart-btn" onclick="resetZoom('progressChart')"><i class="fas fa-search-minus"></i></button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="progressChart"></canvas>
                    </div>
                    <div class="chart-description">
                        Tracks planned vs actual project progress. Gap analysis shows areas needing attention.
                    </div>
                </div>
                
                <!-- Chart 9: Team Workload -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-users"></i> Team Workload</h3>
                        <div class="chart-actions">
                            <button class="chart-btn" onclick="exportChart('workloadChart')"><i class="fas fa-download"></i></button>
                            <button class="chart-btn" onclick="toggleView('workloadChart')"><i class="fas fa-exchange-alt"></i></button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="workloadChart"></canvas>
                    </div>
                    <div class="chart-description">
                        Displays task distribution across team members. Helps identify over/under utilized resources.
                    </div>
                </div>
                
                <!-- Chart 10: Feedback Status -->
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-comment-dots"></i> Feedback Analysis</h3>
                        <div class="chart-actions">
                            <button class="chart-btn" onclick="exportChart('feedbackChart')"><i class="fas fa-download"></i></button>
                            <button class="chart-btn" onclick="toggleView('feedbackChart')"><i class="fas fa-exchange-alt"></i></button>
                        </div>
                    </div>
                    <div class="chart-container">
                        <canvas id="feedbackChart"></canvas>
                    </div>
                    <div class="chart-description">
                        Analyzes feedback by status and priority. Shows resolution progress over time.
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Global chart references
        const charts = {};
        
        // Initialize all charts when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            // Project data
            const projectData = {
                name: "Digital Transformation Initiative",
                status: "Active",
                startDate: "Mar 15, 2023",
                endDate: "Jun 30, 2023",
                creator: "Sarah Johnson",
                progress: 65,
                daysRemaining: 45,
                tasksCompleted: 28,
                totalTasks: 42,
                budgetUsed: 42500,
                totalBudget: 60000,
                teamMembers: 8
            };
            
            // Update DOM with project data
            document.getElementById('projectName').textContent = projectData.name;
            document.getElementById('projectStatus').textContent = projectData.status;
            document.getElementById('projectDates').textContent = `${projectData.startDate} - ${projectData.endDate}`;
            document.getElementById('projectCreator').textContent = `Created by: ${projectData.creator}`;
            document.getElementById('projectProgress').textContent = `Progress: ${projectData.progress}%`;
            document.getElementById('daysRemaining').textContent = projectData.daysRemaining;
            document.getElementById('tasksCompleted').textContent = `${projectData.tasksCompleted}/${projectData.totalTasks}`;
            document.getElementById('budgetUsed').textContent = `$${projectData.budgetUsed.toLocaleString()}`;
            document.getElementById('teamMembers').textContent = projectData.teamMembers;
            
            // Initialize all charts
            initBudgetChart();
            initRiskChart();
            initTaskChart();
            initTimelineChart();
            initKpiChart();
            initAuditChart();
            initSalesChart();
            initProgressChart();
            initWorkloadChart();
            initFeedbackChart();
        });
        
        // Chart 1: Budget Allocation
        function initBudgetChart() {
            const ctx = document.getElementById('budgetChart').getContext('2d');
            charts.budgetChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Spent', 'Remaining'],
                    datasets: [{
                        data: [42500, 17500],
                        backgroundColor: ['#e74c3c', '#2ecc71'],
                        borderWidth: 1
                    }]
                },
                options: getCommonChartOptions('Budget Allocation')
            });
        }
        
        // Chart 2: Risk Assessment
        function initRiskChart() {
            const ctx = document.getElementById('riskChart').getContext('2d');
            charts.riskChart = new Chart(ctx, {
                type: 'bubble',
                data: {
                    datasets: [
                        {
                            label: 'High Impact',
                            data: [
                                {x: 8, y: 9, r: 15},
                                {x: 6, y: 8, r: 10},
                                {x: 5, y: 7, r: 8}
                            ],
                            backgroundColor: 'rgba(231, 76, 60, 0.7)'
                        },
                        {
                            label: 'Medium Impact',
                            data: [
                                {x: 4, y: 5, r: 12},
                                {x: 3, y: 6, r: 8},
                                {x: 5, y: 4, r: 10}
                            ],
                            backgroundColor: 'rgba(241, 196, 15, 0.7)'
                        },
                        {
                            label: 'Low Impact',
                            data: [
                                {x: 2, y: 3, r: 8},
                                {x: 3, y: 2, r: 6},
                                {x: 1, y: 2, r: 5}
                            ],
                            backgroundColor: 'rgba(46, 204, 113, 0.7)'
                        }
                    ]
                },
                options: {
                    ...getCommonChartOptions('Risk Assessment (Likelihood vs Impact)'),
                    scales: {
                        x: {
                            title: {display: true, text: 'Likelihood (1-10)'},
                            min: 0,
                            max: 10
                        },
                        y: {
                            title: {display: true, text: 'Impact (1-10)'},
                            min: 0,
                            max: 10
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: Impact ${context.parsed.y}, Likelihood ${context.parsed.x}`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Chart 3: Task Completion
        function initTaskChart() {
            const ctx = document.getElementById('taskChart').getContext('2d');
            charts.taskChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['High', 'Medium', 'Low'],
                    datasets: [
                        {
                            label: 'Completed',
                            data: [8, 12, 8],
                            backgroundColor: '#2ecc71'
                        },
                        {
                            label: 'Pending',
                            data: [2, 6, 6],
                            backgroundColor: '#e74c3c'
                        }
                    ]
                },
                options: {
                    ...getCommonChartOptions('Tasks by Priority'),
                    scales: {
                        x: {title: {display: true, text: 'Priority Level'}},
                        y: {title: {display: true, text: 'Number of Tasks'}}
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                afterLabel: function(context) {
                                    const total = context.dataset.data[context.dataIndex] + 
                                                  context.chart.data.datasets[1 - context.datasetIndex].data[context.dataIndex];
                                    const percent = Math.round((context.dataset.data[context.dataIndex] / total) * 100);
                                    return `Completion: ${percent}%`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Chart 4: Project Timeline (Gantt)
        function initTimelineChart() {
            const ctx = document.getElementById('timelineChart').getContext('2d');
            
            // Gantt chart data
            const tasks = [
                {task: 'Planning', start: 0, duration: 15, status: 'completed'},
                {task: 'Design', start: 10, duration: 20, status: 'completed'},
                {task: 'Development', start: 25, duration: 30, status: 'in-progress'},
                {task: 'Testing', start: 50, duration: 15, status: 'pending'},
                {task: 'Deployment', start: 60, duration: 10, status: 'pending'}
            ];
            
            const backgroundColors = tasks.map(t => 
                t.status === 'completed' ? '#2ecc71' : 
                t.status === 'in-progress' ? '#3498db' : '#e74c3c');
            
            charts.timelineChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: tasks.map(t => t.task),
                    datasets: [{
                        data: tasks.map(t => t.duration),
                        backgroundColor: backgroundColors,
                        borderColor: backgroundColors.map(c => c.replace('0.6', '1')),
                        borderWidth: 1,
                        barPercentage: 0.6
                    }]
                },
                options: {
                    ...getCommonChartOptions('Project Timeline'),
                    indexAxis: 'y',
                    scales: {
                        x: {
                            title: {display: true, text: 'Days from Start'},
                            min: 0,
                            max: 80
                        },
                        y: {title: {display: true, text: 'Phase'}}
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const task = tasks[context.dataIndex];
                                    return [
                                        `Status: ${task.status.replace('-', ' ')}`,
                                        `Start: Day ${task.start}`,
                                        `Duration: ${task.duration} days`,
                                        `End: Day ${task.start + task.duration}`
                                    ];
                                }
                            }
                        },
                        zoom: {
                            zoom: {
                                wheel: {enabled: true},
                                pinch: {enabled: true},
                                mode: 'x'
                            },
                            pan: {
                                enabled: true,
                                mode: 'x'
                            }
                        }
                    }
                }
            });
        }
        
        // Chart 5: KPI Progress
        function initKpiChart() {
            const ctx = document.getElementById('kpiChart').getContext('2d');
            
            const kpis = [
                {name: 'User Adoption', target: 80, current: 65},
                {name: 'System Uptime', target: 99.9, current: 99.5},
                {name: 'Feature Completion', target: 100, current: 72},
                {name: 'Bug Resolution', target: 95, current: 88},
                {name: 'Training Completion', target: 100, current: 92}
            ];
            
            charts.kpiChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: kpis.map(k => k.name),
                    datasets: [
                        {
                            label: 'Target',
                            data: kpis.map(k => k.target),
                            backgroundColor: 'rgba(46, 204, 113, 0.7)',
                            borderColor: 'rgba(46, 204, 113, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Current',
                            data: kpis.map(k => k.current),
                            backgroundColor: 'rgba(52, 152, 219, 0.7)',
                            borderColor: 'rgba(52, 152, 219, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    ...getCommonChartOptions('KPI Progress vs Targets'),
                    scales: {
                        y: {
                            title: {display: true, text: 'Percentage (%)'},
                            min: 0,
                            max: 100
                        }
                    },
                    plugins: {
                        tooltip: {
                            callbacks: {
                                afterLabel: function(context) {
                                    const kpi = kpis[context.dataIndex];
                                    const diff = kpi.current - kpi.target;
                                    const status = diff >= 0 ? 'ahead' : 'behind';
                                    return `Currently ${Math.abs(diff)}% ${status} target`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Chart 6: Audit Log Activity
        function initAuditChart() {
            const ctx = document.getElementById('auditChart').getContext('2d');
            
            // Simulated audit log data
            const actions = ['Create', 'Update', 'Delete', 'Login', 'Export'];
            const days = 30;
            const datasets = actions.map(action => {
                return {
                    label: action,
                    data: Array.from({length: days}, () => Math.floor(Math.random() * 10)),
                    borderWidth: 1,
                    tension: 0.3
                };
            });
            
            // Assign colors
            const colors = ['#3498db', '#2ecc71', '#e74c3c', '#f39c12', '#9b59b6'];
            datasets.forEach((ds, i) => {
                ds.borderColor = colors[i];
                ds.backgroundColor = colors[i] + '20';
            });
            
            charts.auditChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({length: days}, (_, i) => `Day ${i+1}`),
                    datasets: datasets
                },
                options: {
                    ...getCommonChartOptions('Project Activity Over Time'),
                    scales: {
                        y: {title: {display: true, text: 'Number of Actions'}}
                    },
                    plugins: {
                        zoom: {
                            zoom: {
                                wheel: {enabled: true},
                                pinch: {enabled: true},
                                mode: 'xy'
                            },
                            pan: {
                                enabled: true,
                                mode: 'xy'
                            }
                        }
                    }
                }
            });
        }
        
        // Chart 7: Sales Performance
        function initSalesChart() {
            const ctx = document.getElementById('salesChart').getContext('2d');
            
            const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'];
            const revenue = [12500, 14500, 18200, 16200, 19500, 21000];
            const quantity = [45, 52, 68, 59, 72, 85];
            
            charts.salesChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [
                        {
                            label: 'Revenue ($)',
                            data: revenue,
                            borderColor: '#3498db',
                            backgroundColor: '#3498db20',
                            borderWidth: 2,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Quantity Sold',
                            data: quantity,
                            borderColor: '#2ecc71',
                            backgroundColor: '#2ecc7120',
                            borderWidth: 2,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    ...getCommonChartOptions('Sales Performance'),
                    scales: {
                        y: {
                            type: 'linear',
                            display: 'true',
                            position: 'left',
                            title: {display: true, text: 'Revenue ($)'}
                        },
                        y1: {
                            type: 'linear',
                            display: 'true',
                            position: 'right',
                            title: {display: true, text: 'Quantity Sold'},
                            grid: {drawOnChartArea: false}
                        }
                    }
                }
            });
        }
        
        // Chart 8: Project Progress Tracking
        function initProgressChart() {
            const ctx = document.getElementById('progressChart').getContext('2d');
            
            const weeks = ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6'];
            const planned = [10, 20, 30, 40, 50, 60];
            const actual = [8, 18, 25, 35, 42, 55];
            
            charts.progressChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: weeks,
                    datasets: [
                        {
                            label: 'Planned',
                            data: planned,
                            borderColor: '#3498db',
                            backgroundColor: '#3498db20',
                            borderWidth: 2,
                            borderDash: [5, 5]
                        },
                        {
                            label: 'Actual',
                            data: actual,
                            borderColor: '#2ecc71',
                            backgroundColor: '#2ecc7120',
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    ...getCommonChartOptions('Planned vs Actual Progress'),
                    scales: {
                        y: {
                            title: {display: true, text: 'Completion (%)'},
                            min: 0,
                            max: 100
                        }
                    },
                    plugins: {
                        zoom: {
                            zoom: {
                                wheel: {enabled: true},
                                pinch: {enabled: true},
                                mode: 'xy'
                            },
                            pan: {
                                enabled: true,
                                mode: 'xy'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                afterLabel: function(context) {
                                    const week = context.dataIndex;
                                    const gap = planned[week] - actual[week];
                                    return gap > 0 ? `Behind by ${gap}%` : 
                                           gap < 0 ? `Ahead by ${-gap}%` : 'On track';
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Chart 9: Team Workload
        function initWorkloadChart() {
            const ctx = document.getElementById('workloadChart').getContext('2d');
            
            const teamMembers = ['Sarah', 'Michael', 'David', 'Emily', 'Robert', 'Jessica'];
            const tasks = [12, 8, 15, 6, 10, 9];
            
            charts.workloadChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: teamMembers,
                    datasets: [{
                        label: 'Tasks Assigned',
                        data: tasks,
                        backgroundColor: [
                            '#3498db', '#2ecc71', '#e74c3c', '#f39c12', '#9b59b6', '#1abc9c'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    ...getCommonChartOptions('Team Workload Distribution'),
                    scales: {
                        y: {title: {display: true, text: 'Number of Tasks'}}
                    }
                }
            });
        }
        
        // Chart 10: Feedback Analysis
        function initFeedbackChart() {
            const ctx = document.getElementById('feedbackChart').getContext('2d');
            
            const statuses = ['Open', 'In Progress', 'Resolved', 'Closed'];
            const counts = [8, 12, 15, 20];
            
            charts.feedbackChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: statuses,
                    datasets: [{
                        data: counts,
                        backgroundColor: [
                            '#e74c3c', '#f39c12', '#3498db', '#2ecc71'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    ...getCommonChartOptions('Feedback by Status'),
                    plugins: {
                        datalabels: {
                            formatter: (value, ctx) => {
                                const total = ctx.chart.data.datasets[0].data.reduce((a, b) => a + b, 0);
                                const percentage = Math.round((value / total) * 100);
                                return `${percentage}%`;
                            },
                            color: '#fff',
                            font: {weight: 'bold'}
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }
        
        // Common chart options
        function getCommonChartOptions(title) {
            return {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    title: {
                        display: true,
                        text: title,
                        font: {size: 16}
                    },
                    legend: {
                        position: 'top'
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    },
                    zoom: {
                        zoom: {
                            wheel: {enabled: true},
                            pinch: {enabled: true},
                            mode: 'xy'
                        },
                        pan: {
                            enabled: true,
                            mode: 'xy'
                        }
                    }
                },
                interaction: {
                    mode: 'nearest',
                    axis: 'x',
                    intersect: false
                }
            };
        }
        
        // Export chart as image
        function exportChart(chartId) {
            const link = document.createElement('a');
            link.download = `${charts[chartId].options.plugins.title.text}.png`;
            link.href = document.getElementById(chartId).toDataURL('image/png');
            link.click();
        }
        
        // Toggle between chart views
        function toggleView(chartId) {
            const chart = charts[chartId];
            
            if (chart.config.type === 'pie') {
                chart.config.type = 'bar';
            } else if (chart.config.type === 'bar') {
                chart.config.type = 'line';
            } else {
                chart.config.type = 'pie';
            }
            
            chart.update();
        }
        
        // Reset zoom on chart
        function resetZoom(chartId) {
            if (charts[chartId].resetZoom) {
                charts[chartId].resetZoom();
            }
        }
    </script>
</body>
</html>