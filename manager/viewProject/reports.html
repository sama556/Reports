<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StratAnalytica | KPI Management</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="../../css/comman.css"/>
    <link rel="stylesheet" href="../../css/report.css">
    <link rel="stylesheet" href="../../css/dashboard.css">

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
</head>
<body>
    <header>
        <div class="container header-container">
            <a href="#" class="logo">
                <i class="fas fa-chart-network"></i>
                <span>StratAnalytica</span>
            </a>
            <nav>
                <ul>
                    <li><a href="../view-projects.html"><i class="fas fa-arrow-left"></i> Back</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <div class="dashboard">
        <aside class="sidebar">
            <div class="project-info">
                <h2 id="projectName">Digital Transformation Initiative</h2>
                <span class="project-status active" id="projectStatus">Active</span>
                
                <div class="project-meta">
                    <i class="fas fa-calendar-alt"></i>
                    <span id="projectDates">Mar 15, 2023 - Jun 30, 2023</span>
                </div>
                <div class="project-meta">
                    <i class="fas fa-user"></i>
                    <span id="projectCreator">Created by: Sarah Johnson</span>
                </div>
                <div class="project-meta">
                    <i class="fas fa-chart-pie"></i>
                    <span id="projectProgress">Progress: 65%</span>
                </div>
            </div>
            <ul class="sidebar-menu">
                <li><a href="../../manger/projectView/project-dashboard.html" id="dashboardLink"><i class="fas fa-tachometer-alt"></i> Dashboard</a></li>
                <li><a href="../../manager/viewProject/risks.html"><i class="fas fa-exclamation-triangle"></i> Risks</a></li>
                <li><a href="../../manager/viewProject/kpis.html" id="kpisLink"><i class="fas fa-bullseye"></i> KPIs</a></li>
                <li><a href="../../manager/viewProject/Sales-Performance.html"><i class="fas fa-chart-line"></i> Sales Performance</a></li>
                <li><a href="../../manager/viewProject/feedback.html"><i class="fas fa-comment"></i> Feedback</a></li>
                <li><a href="../../manager/viewProject/todo.html"><i class="fas fa-tasks"></i> To-do List</a></li>
                <li><a href="../../manager/viewProject/notifications.html"><i class="fas fa-bell"></i> Notifications</a></li>
                <li><a href="../../manager/viewProject/reports.html" class="active"><i class="fas fa-file-export"></i> Reports</a></li>
            </ul>
        </aside>

        <main class="main-content">
            <div class="card">
                <div class="container">
                    <div class="header">
                        <h1>Export Reports</h1>
                    
                    </div>
                    
                    <div class="reports-dashboard">
                        <!-- Report 1: Project Summary -->
                        <div class="report-card">
                            <div class="report-header">
                                <div class="report-icon summary">
                                    <i class="fas fa-project-diagram"></i>
                                </div>
                                <div>
                                    <div class="report-title">Project Summary Report</div>
                                </div>
                            </div>
                            <div class="report-description">
                                Comprehensive report containing complete project summary, objectives, team, and current status.
                            </div>
                            <div class="export-options">
                                <button class="export-btn pdf" onclick="exportReport('project-summary', 'pdf')">
                                    <span>Export as PDF</span>
                                    <i class="fas fa-file-pdf"></i>
                                </button>
                                <button class="export-btn excel" onclick="exportReport('project-summary', 'excel')">
                                    <span>Export as Excel</span>
                                    <i class="fas fa-file-excel"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Report 2: Project Budget -->
                        <div class="report-card">
                            <div class="report-header">
                                <div class="report-icon budget">
                                    <i class="fas fa-wallet"></i>
                                </div>
                                <div>
                                    <div class="report-title">Project Budget Report</div>
                                </div>
                            </div>
                            <div class="report-description">
                                Detailed analysis of budget, expenses, profits, and financial projections for the project.
                            </div>
                            <div class="export-options">
                                <button class="export-btn pdf" onclick="exportReport('project-budget', 'pdf')">
                                    <span>Export as PDF</span>
                                    <i class="fas fa-file-pdf"></i>
                                </button>
                                <button class="export-btn excel" onclick="exportReport('project-budget', 'excel')">
                                    <span>Export as Excel</span>
                                    <i class="fas fa-file-excel"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Report 3: Project Risks -->
                        <div class="report-card">
                            <div class="report-header">
                                <div class="report-icon risks">
                                    <i class="fas fa-exclamation-triangle"></i>
                                </div>
                                <div>
                                    <div class="report-title">Project Risks Report</div>
                                </div>
                            </div>
                            <div class="report-description">
                                Assessment of potential risks, their impact, mitigation measures, and status of each risk.
                            </div>
                            <div class="export-options">
                                <button class="export-btn pdf" onclick="exportReport('project-risks', 'pdf')">
                                    <span>Export as PDF</span>
                                    <i class="fas fa-file-pdf"></i>
                                </button>
                                <button class="export-btn excel" onclick="exportReport('project-risks', 'excel')">
                                    <span>Export as Excel</span>
                                    <i class="fas fa-file-excel"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Report 4: Completed Tasks -->
                        <div class="report-card">
                            <div class="report-header">
                                <div class="report-icon tasks">
                                    <i class="fas fa-tasks"></i>
                                </div>
                                <div>
                                    <div class="report-title">Project Completion Report</div>
                                </div>
                            </div>
                            <div class="report-description">
                                Overview of completed tasks, completion rate, and team performance.
                            </div>
                            <div class="export-options">
                                <button class="export-btn pdf" onclick="exportReport('project-completion', 'pdf')">
                                    <span>Export as PDF</span>
                                    <i class="fas fa-file-pdf"></i>
                                </button>
                                <button class="export-btn excel" onclick="exportReport('project-completion', 'excel')">
                                    <span>Export as Excel</span>
                                    <i class="fas fa-file-excel"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Report 5: Project Timeline -->
                        <div class="report-card">
                            <div class="report-header">
                                <div class="report-icon timeline">
                                    <i class="fas fa-calendar-alt"></i>
                                </div>
                                <div>
                                    <div class="report-title">Project Timeline Report</div>
                                </div>
                            </div>
                            <div class="report-description">
                                Project timeline, key milestones, critical dates, and actual progress.
                            </div>
                            <div class="export-options">
                                <button class="export-btn pdf" onclick="exportReport('project-timeline', 'pdf')">
                                    <span>Export as PDF</span>
                                    <i class="fas fa-file-pdf"></i>
                                </button>
                                <button class="export-btn excel" onclick="exportReport('project-timeline', 'excel')">
                                    <span>Export as Excel</span>
                                    <i class="fas fa-file-excel"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Report 6: KPIs -->
                        <div class="report-card">
                            <div class="report-header">
                                <div class="report-icon kpi">
                                    <i class="fas fa-bullseye"></i>
                                </div>
                                <div>
                                    <div class="report-title">Project KPIs Report</div>
                                </div>
                            </div>
                            <div class="report-description">
                                Measurement of project performance according to key performance indicators and comparison with objectives.
                            </div>
                            <div class="export-options">
                                <button class="export-btn pdf" onclick="exportReport('project-kpis', 'pdf')">
                                    <span>Export as PDF</span>
                                    <i class="fas fa-file-pdf"></i>
                                </button>
                                <button class="export-btn excel" onclick="exportReport('project-kpis', 'excel')">
                                    <span>Export as Excel</span>
                                    <i class="fas fa-file-excel"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Report 7: Audit Log -->
                        <div class="report-card">
                            <div class="report-header">
                                <div class="report-icon audit">
                                    <i class="fas fa-clipboard-list"></i>
                                </div>
                                <div>
                                    <div class="report-title">Project Audit Log Report</div>
                                </div>
                            </div>
                            <div class="report-description">
                                Complete record of all operations, changes, and important events in the project.
                            </div>
                            <div class="export-options">
                                <button class="export-btn pdf" onclick="exportReport('project-audit', 'pdf')">
                                    <span>Export as PDF</span>
                                    <i class="fas fa-file-pdf"></i>
                                </button>
                                <button class="export-btn excel" onclick="exportReport('project-audit', 'excel')">
                                    <span>Export as Excel</span>
                                    <i class="fas fa-file-excel"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Report 8: Feedback -->
                        <div class="report-card">
                            <div class="report-header">
                                <div class="report-icon feedback">
                                    <i class="fas fa-comments"></i>
                                </div>
                                <div>
                                    <div class="report-title">User Feedback Report</div>
                                </div>
                            </div>
                            <div class="report-description">
                                Analysis of user feedback, improvement suggestions, and satisfaction level.
                            </div>
                            <div class="export-options">
                                <button class="export-btn pdf" onclick="exportReport('project-feedback', 'pdf')">
                                    <span>Export as PDF</span>
                                    <i class="fas fa-file-pdf"></i>
                                </button>
                                <button class="export-btn excel" onclick="exportReport('project-feedback', 'excel')">
                                    <span>Export as Excel</span>
                                    <i class="fas fa-file-excel"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Report 9: Sales Performance -->
                        <div class="report-card">
                            <div class="report-header">
                                <div class="report-icon sales">
                                    <i class="fas fa-chart-line"></i>
                                </div>
                                <div>
                                    <div class="report-title">Sales Performance Report</div>
                                </div>
                            </div>
                            <div class="report-description">
                                Sales performance, profits, financial analysis, and comparison with projections.
                            </div>
                            <div class="export-options">
                                <button class="export-btn pdf" onclick="exportReport('project-sales', 'pdf')">
                                    <span>Export as PDF</span>
                                    <i class="fas fa-file-pdf"></i>
                                </button>
                                <button class="export-btn excel" onclick="exportReport('project-sales', 'excel')">
                                    <span>Export as Excel</span>
                                    <i class="fas fa-file-excel"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
        </main>
    </div>
    <script>
        // Language switching functionality
        document.getElementById('arBtn').addEventListener('click', function() {
            window.location.href = 'reports-ar.html'; // Link to Arabic version
        });
        
        document.getElementById('enBtn').addEventListener('click', function() {
            // Already on English version
            this.classList.add('active');
            document.getElementById('arBtn').classList.remove('active');
        });
        
        // Export report function
        function exportReport(reportType, format) {
            const reportNames = {
                'project-summary': 'Project Summary Report',
                'project-budget': 'Project Budget Report',
                'project-risks': 'Project Risks Report',
                'project-completion': 'Project Completion Report',
                'project-timeline': 'Project Timeline Report',
                'project-kpis': 'Project KPIs Report',
                'project-audit': 'Project Audit Log Report',
                'project-feedback': 'User Feedback Report',
                'project-sales': 'Sales Performance Report'
            };
            
            const reportName = reportNames[reportType];
            const formatName = format.toUpperCase();
            
            Swal.fire({
                title: 'Select Report Range',
                html: `
                    <div style="text-align: left; margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 500;">
                            Time Range
                        </label>
                        <select id="reportRange" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
                            <option value="all">All Time</option>
                            <option value="month">This Month</option>
                            <option value="quarter">This Quarter</option>
                            <option value="year">This Year</option>
                            <option value="custom">Custom Range</option>
                        </select>
                    </div>
                    <div id="customRangeContainer" style="display: none; text-align: left; margin-top: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 500;">
                            Select Custom Range
                        </label>
                        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                            <input type="date" id="startDate" style="flex: 1; padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
                            <span>to</span>
                            <input type="date" id="endDate" style="flex: 1; padding: 8px; border-radius: 4px; border: 1px solid #ddd;">
                        </div>
                    </div>
                `,
                showCancelButton: true,
                confirmButtonText: 'Export',
                confirmButtonColor: '#4a6bdf',
                cancelButtonText: 'Cancel',
                didOpen: () => {
                    const rangeSelect = document.getElementById('reportRange');
                    const customRangeContainer = document.getElementById('customRangeContainer');
                    
                    rangeSelect.addEventListener('change', function() {
                        customRangeContainer.style.display = this.value === 'custom' ? 'block' : 'none';
                    });
                    
                    // Set default dates for custom range
                    const today = new Date();
                    const lastMonth = new Date();
                    lastMonth.setMonth(today.getMonth() - 1);
                    
                    document.getElementById('endDate').valueAsDate = today;
                    document.getElementById('startDate').valueAsDate = lastMonth;
                },
                preConfirm: () => {
                    const range = document.getElementById('reportRange').value;
                    let rangeText = '';
                    
                    if (range === 'custom') {
                        const startDate = document.getElementById('startDate').value;
                        const endDate = document.getElementById('endDate').value;
                        
                        if (!startDate || !endDate) {
                            Swal.showValidationMessage('Please select both start and end dates');
                            return false;
                        }
                        
                        rangeText = `Custom (${startDate} to ${endDate})`;
                    } else {
                        const rangeTexts = {
                            'all': 'All Time',
                            'month': 'This Month',
                            'quarter': 'This Quarter',
                            'year': 'This Year'
                        };
                        rangeText = rangeTexts[range];
                    }
                    
                    return {
                        reportType,
                        reportName,
                        format,
                        range,
                        rangeText
                    };
                }
            }).then((result) => {
                if (result.isConfirmed) {
                    // In a real app, this would generate and download the report
                    // For demo purposes, we'll show a success message
                    Swal.fire({
                        icon: 'success',
                        title: 'Report Exported',
                        html: `
                            <div style="text-align: left;">
                                <p><strong>Report:</strong> ${result.value.reportName}</p>
                                <p><strong>Format:</strong> ${result.value.format.toUpperCase()}</p>
                                <p><strong>Time Range:</strong> ${result.value.rangeText}</p>
                            </div>
                        `,
                        confirmButtonText: 'OK',
                        confirmButtonColor: '#4a6bdf'
                    });
                }
            });
        }
    </script>
</body>
</html>